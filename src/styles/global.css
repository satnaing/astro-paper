@import "tailwindcss";
@import "./typography.css";

@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *));

/*
 * Theme CSS variables are injected by Layout.astro from src/config.ts
 * This file only maps CSS variables to Tailwind color utilities
 * To change themes, update ACTIVE_THEME in src/config.ts
 */

/*
 * Astro Code Block Theme Variables
 * Maps syntax highlighting colors to theme variables
 * Used when shikiConfig.theme is set to "css-variables" in astro.config.ts
 * Astro uses --astro-code-* prefix instead of --shiki-*
 */
:root {
  /* Code block background/foreground - used by Astro's inline styles */
  --astro-code-background: var(--muted);
  --astro-code-foreground: var(--foreground);
  /* Syntax highlighting tokens */
  --astro-code-token-constant: var(--primary);
  --astro-code-token-string: var(--secondary-foreground);
  --astro-code-token-comment: var(--muted-foreground);
  --astro-code-token-keyword: var(--primary);
  --astro-code-token-parameter: var(--foreground);
  --astro-code-token-function: var(--ring);
  --astro-code-token-string-expression: var(--secondary-foreground);
  --astro-code-token-punctuation: var(--muted-foreground);
  --astro-code-token-link: var(--primary);
}

[data-theme="dark"] {
  /* Dark mode: use popover for subtle lift from background */
  --astro-code-background: var(--popover);
  --astro-code-foreground: var(--foreground);
  --astro-code-token-constant: var(--primary);
  --astro-code-token-string: var(--muted-foreground);
  --astro-code-token-comment: var(--muted-foreground);
  --astro-code-token-keyword: var(--primary);
  --astro-code-token-parameter: var(--foreground);
  --astro-code-token-function: var(--ring);
  --astro-code-token-string-expression: var(--muted-foreground);
  --astro-code-token-punctuation: var(--muted-foreground);
  --astro-code-token-link: var(--primary);
}

@theme inline {
  --font-app: var(--font-jetbrains-mono);

  /* Core colors */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-border: var(--border);

  /* Semantic colors */
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  /* UI element colors */
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-input: var(--input);
  --color-ring: var(--ring);

  /* Backward compatibility: accent maps to primary */
  --color-accent: var(--primary);
  --color-accent-foreground: var(--primary-foreground);
}

@layer base {
  * {
    @apply border-border outline-accent/75;
    scrollbar-width: auto;
    scrollbar-color: var(--color-muted) transparent;
  }
  html {
    @apply overflow-y-scroll scroll-smooth;
  }
  body {
    @apply flex min-h-svh flex-col bg-background font-app text-foreground selection:bg-accent/75 selection:text-background;
  }
  a,
  button {
    @apply outline-offset-1 outline-accent focus-visible:no-underline focus-visible:outline-2 focus-visible:outline-dashed;
  }
  button:not(:disabled),
  [role="button"]:not(:disabled) {
    cursor: pointer;
  }
}

@utility max-w-app {
  @apply max-w-3xl;
}

@utility app-layout {
  @apply mx-auto w-full max-w-app px-4;
}

.active-nav {
  @apply underline decoration-wavy decoration-2 underline-offset-8;
}

/* Source: https://piccalil.li/blog/a-more-modern-css-reset/ */
/* Anything that has been anchored to should have extra scroll margin */
:target {
  scroll-margin-block: 1rem;
}
