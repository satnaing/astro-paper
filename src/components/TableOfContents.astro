---
type Heading = {
  depth: number;
  slug: string;
  text: string;
};

type Props = {
  headings: Heading[];
};

const { headings } = Astro.props;

// Filter to h2 and h3 only
const tocHeadings = headings.filter(h => h.depth >= 2 && h.depth <= 3);
---

{
  tocHeadings.length > 0 && (
    <details class="mt-8 mb-4">
      <summary class="cursor-pointer">
        Table of Contents
      </summary>
      <ul class="mt-2 space-y-1 border border-border/50 bg-(--astro-code-background) p-4 text-muted-foreground">
        {tocHeadings.map(heading => (
          <li class:list={[heading.depth === 3 && "ml-4"]}>
            <a href={`#${heading.slug}`} class="hover:text-foreground">
              {heading.text}
            </a>
          </li>
        ))}
      </ul>
    </details>
  )
}
